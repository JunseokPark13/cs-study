# 프로세스의 주소 공간

<br>

![Untitled (1)](https://user-images.githubusercontent.com/49611158/146753832-c9dae74f-be62-49b8-9462-05765fe05719.png)

<br>

## 메모리 영역

### Code (Text)
+ 우리가 작성한 소스코드가 들어 가는 부분. 
+ 실행할 프로그램의 코드가 저장되는 영역으로, 텍스트 영역이라고도 부른다.
+ 코드 영역은 실행 파일을 구성하는 명령어들이 올라가는 메모리 영역으로 함수, 제어문, 상수 등이 여기에 지정된다.
+ 컴파일 타임에 결정되고, 중간에 코드를 바꿀 수 없게 Read-Only 로 지정되어있다.
+ Code 영역이 따로 존재하는 이유
    - 프로그램의 Code 는 프로그램이 만들어지고(컴파일되고) 난 뒤에는 바뀔 일이 없다. 따라서 읽기만 가능한 Read Only 부분이다.
    - 같은 프로그램을 실행 시켜 몇 개의 프로세스가 실행되더라도 모두 같은 Code 내용을 가지고 있게 되므로, 같은 프로그램의 프로세스일 경우 Code 부분을 공유하여 메모리 사용량을 줄일 수 있다.

### Data
+ 프로그램의 전역변수와 정적변수가 저장되는 영역
+ 프로그램이 구동되는 동안 항상 접근 가능한 변수가 저장되는 영역이다.
+ 전역변수, static 을 참조한 코드는 컴파일된 뒤 Data 영역의 주소값을 가리키도록 바뀐다.
+ 데이터 영역은 프로그램의 시작과 함께 할당되고, 프로그램이 종료되면 소멸한다.
+ 실행 중도에 전역변수로 변경될 수 있으므로 이 영역은 Read-Write로 지정되어있다.
+ 범위가 정해져있지 않거나 초기화되지 않은 데이터는 BBS(Block Stated Symbol) 영역에 저장된다.
+ Data 와 BSS 영역을 나누는 이유
    - 초기화되지 않은 변수는 프로그램이 실행될 때 영역만 잡아주면 되고, 그 값을 프로그램에 저장하고 있을 필요는 없다.
    - 초기화 된 변수는 그 값을 프로그램이 가지고 있어야 한다.
    - 이에 따라 bss 영역 변수들이 많아져서 프로그램의 실행 코드 사이즈가 늘어나지는 않는다.

### Stack
+ 함수의 호출과 관계되는 지역 변수와 매개변수가 저장되는 영역이다.
+ Stack은 함수의 호출과 함께 할당되고, 함수의 호출이 완료되면 소멸한다.
+ 원시타입의 데이터가 값과 함께 할당된다.
+ Heap 영역에 생성된 Object 타입의 데이터 참조값이 할당된다.
+ 메모리의 높은 주소에서 낮은 주소의 방향으로 할당된다.
+ 컴파일 타임에 크기가 결정되므로 무한히 할당할 수 없다.
    - 재귀함수가 너무 깊게 호출되거나, 함수가 지역변수를 너무 많이 가지고있어 stack 영역을 초과하면 stack overflow 에러가 발생한다.
+ Stack 과 Data 가 나뉘어진 이유
    - Stack 은 후입선출 방식의 데이터 구조를 가지고 있지만, Data 의 전역 변수들은 어떤 함수에서도 접근이 가능해야 하므로 서로 다른 구조이기에 별도의 영역으로 구분을 하는 것이다.

### Heap
+ 런타임에 크기가 결정되는 메모리 영역이다.
+ 사용자에 의해 메모리 공간이 동적으로 할당되고 해제된다.
+ 참조형의 데이터 값이 저장된다.
+ 클래스, 클로저 등이 해당된다.
+ Heap은 메모리의 낮은 주소에서 높은 주소의 방향으로 할당된다.
+ Heap 과 Stack은 같은 공간을 공유한다.
    - Heap 은 메모리 아래쪽 주소부터 할당되고, Stack 은 위쪽 부터 할당된다.
    - 서로의 공간을 침범할 경우, Heap Overflow, Stack Overflow 라고 한다. 


