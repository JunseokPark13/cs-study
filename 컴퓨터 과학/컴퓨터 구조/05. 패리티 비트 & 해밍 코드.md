# 패리티 비트 & 해밍 코드

+ 네트워크 통신 시에는 물리적인 장애물이나 잡음 등의 이유로 데이터가 유실되거나 변경될 가능성이 있다. 
+ 때문에 데이터를 수신하는 수신부는 수신받은 데이터가 정확한 데이터가 아닐 것이라는 가정 하에 오류를 검사해야한다.

<br>

## 패리티 비트 (Parity Bit)
+ 정보전달 과정에서 오류 발생여부를 검사하기 위해 추가된 비트를 의미한다.
+ 전송하고자 하는 데이터의 끝에 1비트를 더하여 전송한다.
+ 패리티 비트는 홀수(odd) 패리티 비트와 짝수(even) 패리티 비트로 나뉜다 . 전달하고자 하는 데이터의 1 개수로 홀짝을 구분한다.
    - 짝수 패리티 : 각 전송 비트 내에 1 의 개수가 짝수가 되도록 한다. 주로 비동기식 전송에 사용한다.
    - 홀수 패리티 : 각 전송 비트 내에 1 의 개수가 홀수가 되도록 한다. 주로 동기식 전송에 사용한다.
+ 짝수, 홀수 중 어떤 패리티를 사용할지는 미리 송수신측에서 동기화되어 있어야 한다.

```
전송할 데이터가 '1001101' 일 때, 1 의 개수는 현재 4개이다.

1. 짝수 패리티일 경우
이미 1이 4개로 짝수이므로 패리티 비트는 0을 붙인다.

2. 홀수 패리티일 경우
1이 4개로 짝수이므로, 개수를 홀수로 만들기 위해 패리티 비트는 1을 붙인다.
```

+ 가장 간단하게 오류를 검출할 수 있는 방식이지만, 두 개의 비트에서 동시에 오류가 발생하면 검출이 불가능하다.
+ 패리티 비트는 오류 검출에만 사용할 수 있고 수정은 불가능하다.

<br>

## 해밍 코드 (Hamming Code)
+ 하나의 데이터 단위에 대해 충분한 패리티 비트를 추가하여 수신측이 패리티 비트로 오류를 검출 및 수정할 수 있도록 한다.
+ 검출 및 수정까지 할 수 있으므로 자기 정정 부호라고도 불린다.
+ 코드의 생성 과정은 다음과 같다.
    - 1) 최소 패리티 비트 수 결정
        + `2^P <= P + D + 1` 의 공식을 만족하는 값을 찾는다.    
        여기서 P 는 패리티 비트의 수, D 는 보내고자 하는 데이터 크기를 의미한다.     
        D 가 4라면, `2^P <= P + 4 + 1` 을 만족하는 가장 작은 P 는 3이다.
    - 2) 패리티 비트의 위치 결정
        + n 번째 패리티 비트는 `2^(n - 1)` 의 위치에 들어간다. (1, 2, 4, 8, ...)
    - 3)  패리티 비트 결정
        + 패리티 범위 원소들의 XOR 연산으로 결정된다. 각 n번째 패리티 비트들의 범위는 다음과 같다.
        + ![수정됨_hamming1](https://user-images.githubusercontent.com/49611158/145570469-b5f644e8-4507-490c-96c5-e8f93d86d96f.jpg)
    - 4) 수신된 패리티 비트들을 비교하여 에러를 확인한다.     
    송신된 패리티 비트들과 수신된 패리티 비트들을 XOR 하여 나온 값의 위치가 오류가 발생한 비트임을 알 수 있다.    

<br>

+ `01010101` 이라는 8비트 데이터를 송신한다고 가정해보자

1. `2^p <= p + 8 + 1` 을 만족하는 p 는 4 이다. 따라서 패리티 비트는 4개가 들어가야한다.
2. 4개의 패리티 비트가 삽입되어야 하므로 P1, P2, P4, P8 위치를 제외하고 나머지 위치에 데이터 비트를 넣는다.    

![수정됨_ham1](https://user-images.githubusercontent.com/49611158/145572759-e69b92f6-218c-4d2f-8085-e53417153d97.jpg)    

<br>

3. P1, P2, P4, P8 위치에 패리티 비트를 삽입한다.
```
짝수 패리티라고 생각했을 때
P1 의 경우 D3, D5, D7, D9, D11 이 1, 0, 0, 1, 1 이므로 P1 = 1
P2 의 경우 D3, D6, D7, D10, D11 이 1, 1, 0, 0, 1 이므로 P2 = 1
P4 의 경우 D5, D6, D7, D12 이 0, 1, 0, 0 이므로 P4 = 1
P8 의 경우 D9, D10, D11, D12 이 1, 0, 1, 0 이므로 P8 = 0
최종적으로 송신한 정상적인 패리티 비트는 `0111` 이 된다.    
```    
![수정됨_ham2](https://user-images.githubusercontent.com/49611158/145573420-19b8091d-ca09-4157-a8a6-8c9b8076f956.jpg)     

<br>

4. 그런데 여기서 9번째 비트에 에러가 발생했을 경우, 수신된 데이터는 아래 그림과 같이 `1110` 의 패리티 비트를 수신하게 될 것이다.    
    
![수정됨_ham3](https://user-images.githubusercontent.com/49611158/145573551-24925683-e6d2-453e-827d-71be6a10988d.jpg)    

<br>

5. 정상 패리티 비트 `0111` 과 `1110` 을 XOR 연산 하면 `1001` 이고, 이를 10진수로 변환하면 9 이므로 9번째 비트인 D9 가 에러 비트인 것을 알 수 있다. D9 를 반전하면 잘못된 데이터를 정정할 수 있다.
